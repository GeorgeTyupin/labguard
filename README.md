# LabGuard

Платформа лицензирования и защиты образовательного контента с автоматической проверкой доступа через десктопный клиент.

## О продукте

LabGuard решает проблему продажи и защиты лабораторных работ, курсовых проектов и других образовательных материалов. Студенты покупают доступ через Telegram-бота, получают персональную лицензию, которая проверяется специальным клиентом перед запуском работы.

**Ключевые возможности:**
- Покупка лицензий через удобный Telegram-интерфейс
- Защита от копирования через fingerprint устройства
- Автоматическая проверка доступа при запуске материалов
- Централизованное управление лицензиями

## Архитектура

Система состоит из трёх компонентов:

```
┌─────────────┐      ┌──────────────┐      ┌─────────────┐
│ Telegram    │─────▶│ HTTP Server  │◀─────│   Client    │
│    Bot      │      │     API      │      │ (labguard   │
│             │      │              │      │    .exe)    │
└─────────────┘      └──────┬───────┘      └─────────────┘
     │                      │                      │
     │                      ▼                      │
     │               ┌──────────────┐              │
     └──────────────▶│  PostgreSQL  │◀─────────────┘
                     └──────────────┘
```

### 1. Telegram Bot
Интерфейс для студентов. Регистрация, просмотр каталога, покупка продуктов.

**Команды:**
- `/start` — регистрация и получение токена
- `/catalog` — просмотр доступных продуктов
- `/my` — личный кабинет с купленными продуктами

**Стек:** telebot.v4, Go 1.25

### 2. HTTP Server
REST API для взаимодействия бота и клиента с базой данных.

**Эндпоинты:**
- `POST /api/v1/users` — регистрация пользователя
- `POST /api/v1/verify` — проверка лицензии (из клиента)
- `GET /api/v1/products` — получение каталога

**Стек:** Chi router, PostgreSQL (pgx)

### 3. Desktop Client
Exe-файл, который проверяет лицензию перед запуском образовательных материалов.

**Логика:**
1. Читает токен из `labguard.key`
2. Генерирует fingerprint устройства
3. Отправляет запрос на сервер
4. Exit code: 0 = доступ есть, 1 = нет

## Архитектурные принципы

- **Clean Architecture** — handler → service → repository
- **Dependency Injection** — зависимости через конструкторы
- **Consumer-side interfaces** — идиоматичный Go-подход
- **Graceful shutdown** — корректное завершение приложений

## Roadmap

### Ближайшее будущее

**Платёжная интеграция**
- Интеграция с ЮKassa/Robokassa
- Автоматическое подтверждение оплаты
- Уведомления о статусе платежа

**Защита контента**
- Полная реализация fingerprint-защиты
- Сброс устройства (1 раз в 30 дней)
- Защита от переноса на другой ПК

**База данных**
- Миграции (golang-migrate)
- Полная схема БД (users, products, purchases, devices)
- Транзакционность операций покупки

### Перспективные фичи

**Административная панель**
- Добавление новых продуктов
- Статистика продаж
- Управление пользователями
- Ручное подтверждение платежей

**Интеграция с GitHub**
- Автоматическая выдача доступа к private репозиториям
- Синхронизация через GitHub API
- Отзыв доступа при истечении лицензии

**Улучшение клиента**
- Автообновление клиента
- Offline-режим (временные лицензии)
- Более надёжный fingerprinting

**Расширение функциональности**
- Подписки (ежемесячный доступ)
- Групповые лицензии (для ВУЗов)
- Промокоды и скидки
- Реферальная система

## Запуск

```bash
# Telegram бот
go run cmd/bot/main.go

# HTTP сервер
go run cmd/server/main.go
```

**Требования:** Go 1.25+, PostgreSQL 14+

---
